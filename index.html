
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>è…¸é“å¥åº·èª¿æŸ¥å•å·</title>
  <style>
    body { font-family: "Noto Sans TC", sans-serif; background: #f4f6f9; padding: 20px; }
    .container { max-width: 800px; background: white; padding: 30px; margin: auto; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; }
    label { font-weight: bold; display: block; margin-top: 20px; }
    .options label { font-weight: normal; display: inline-block; margin-right: 15px; }
    textarea { width: 100%; margin-top: 10px; padding: 8px; }
    button { margin-top: 30px; padding: 10px 20px; background: #0078D7; color: white; border: none; border-radius: 5px; cursor: pointer; }
    #result { margin-top: 30px; padding: 20px; background: #ecf0f1; border-radius: 8px; }
    .product-box { margin-top: 15px; background: #fff; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>è…¸é“å¥åº·èª¿æŸ¥å•å·</h1>
    <form id="healthForm">
<label>1. æ‚¨çš„å¹´é½¡ï¼š</label><div class="options"><label><input type="radio" name="q1_age" value="4:å°æ–¼20æ­²">å°æ–¼20æ­²</label><label><input type="radio" name="q1_age" value="4:20-29æ­²">20-29æ­²</label><label><input type="radio" name="q1_age" value="4:30-39æ­²">30-39æ­²</label><label><input type="radio" name="q1_age" value="4:40-49æ­²">40-49æ­²</label><label><input type="radio" name="q1_age" value="4:50æ­²ä»¥ä¸Š">50æ­²ä»¥ä¸Š</label></div>
<label>2. æ‚¨çš„æ€§åˆ¥ï¼š</label><div class="options"><label><input type="radio" name="q2_gender" value="0:ç”·">ç”·</label><label><input type="radio" name="q2_gender" value="0:å¥³">å¥³</label></div>
<label>3. æ‚¨æ˜¯å¦æœ‰è¼ªç­æˆ–å¤œç­å·¥ä½œï¼Ÿ</label><div class="options"><label><input type="radio" name="q3_shift" value="1:æœ‰">æœ‰</label><label><input type="radio" name="q3_shift" value="4:ç„¡">ç„¡</label></div>
<label>4. ç¡çœ æƒ…æ³å¦‚ä½•ï¼Ÿ</label><div class="options"><label><input type="radio" name="q4_sleep" value="4:éå¸¸å¥½">éå¸¸å¥½</label><label><input type="radio" name="q4_sleep" value="3:é‚„å¯">é‚„å¯</label><label><input type="radio" name="q4_sleep" value="2:æœ‰æ™‚å¥½æœ‰æ™‚ä¸å¥½">æœ‰æ™‚å¥½æœ‰æ™‚ä¸å¥½</label><label><input type="radio" name="q4_sleep" value="1:å¾ˆé›£ç¡">å¾ˆé›£ç¡</label></div>
<label>5. æ‚¨å¹³å‡æ¯å¤©ç¡çœ å¹¾å°æ™‚ï¼Ÿ</label><div class="options"><label><input type="radio" name="q5_hours" value="1:å°‘æ–¼5å°æ™‚">å°‘æ–¼5å°æ™‚</label><label><input type="radio" name="q5_hours" value="2:5-6å°æ™‚">5-6å°æ™‚</label><label><input type="radio" name="q5_hours" value="3:7-8å°æ™‚">7-8å°æ™‚</label><label><input type="radio" name="q5_hours" value="4:9å°æ™‚ä»¥ä¸Š">9å°æ™‚ä»¥ä¸Š</label></div>
<label>6. æ˜¯å¦å¸¸æ„Ÿåˆ°ç–²å‹ï¼Ÿ</label><div class="options"><label><input type="radio" name="q6_fatigue" value="4:å¹¾ä¹æ²’æœ‰">å¹¾ä¹æ²’æœ‰</label><label><input type="radio" name="q6_fatigue" value="3:å¶çˆ¾">å¶çˆ¾</label><label><input type="radio" name="q6_fatigue" value="2:æ¯”è¼ƒå¸¸è¦‹">æ¯”è¼ƒå¸¸è¦‹</label><label><input type="radio" name="q6_fatigue" value="1:å¸¸å¸¸å¦‚æ­¤">å¸¸å¸¸å¦‚æ­¤</label></div>
<label>7. æœ‰ç„¡è…¸èƒƒä¸é©ï¼ˆå¦‚è…¹ç€‰ã€ä¾¿ç§˜ã€èƒƒè„¹æ°£ï¼Ÿ</label><div class="options"><label><input type="radio" name="q7_gut" value="4:æ²’æœ‰">æ²’æœ‰</label><label><input type="radio" name="q7_gut" value="2:å¶çˆ¾">å¶çˆ¾</label><label><input type="radio" name="q7_gut" value="1:å¸¸å¸¸">å¸¸å¸¸</label></div>
<label>8. æœ‰ç„¡æ’ä¾¿ç•°å¸¸ï¼ˆå¦‚ä¾¿ç§˜ã€è…¹ç€‰ï¼‰ï¼Ÿ</label><div class="options"><label><input type="radio" name="q8_bowel" value="4:æ²’æœ‰">æ²’æœ‰</label><label><input type="radio" name="q8_bowel" value="2:å¶çˆ¾">å¶çˆ¾</label><label><input type="radio" name="q8_bowel" value="1:å¸¸å¸¸">å¸¸å¸¸</label></div>
<label>9. æœ‰ç„¡è…¹è„¹ã€èƒƒé…¸å€’æµï¼Ÿ</label><div class="options"><label><input type="radio" name="q9_bloat" value="4:æ²’æœ‰">æ²’æœ‰</label><label><input type="radio" name="q9_bloat" value="2:å¶çˆ¾">å¶çˆ¾</label><label><input type="radio" name="q9_bloat" value="1:å¸¸å¸¸">å¸¸å¸¸</label></div>
<label>10. æœ‰ç„¡æƒ…ç·’ä½è½ã€ç·Šå¼µç…©èºï¼Ÿ</label><div class="options"><label><input type="radio" name="q10_emotion" value="4:æ²’æœ‰">æ²’æœ‰</label><label><input type="radio" name="q10_emotion" value="2:å¶çˆ¾">å¶çˆ¾</label><label><input type="radio" name="q10_emotion" value="1:å¸¸å¸¸">å¸¸å¸¸</label></div>
<label>11. è‚Œè†šæœ‰é¬†å¼›ã€æš—å•ã€çšºç´‹ç­‰è€åŒ–ç¾è±¡ï¼Ÿ</label><div class="options"><label><input type="radio" name="q11_skin" value="4:æ²’æœ‰">æ²’æœ‰</label><label><input type="radio" name="q11_skin" value="2:æœ‰ä¸€é»">æœ‰ä¸€é»</label><label><input type="radio" name="q11_skin" value="1:å¾ˆå¤š">å¾ˆå¤š</label></div>
<label>12. æ¯é€±å¤§ç´„é‹å‹•å¹¾æ¬¡ï¼Ÿï¼ˆè¨ˆå…¥æ•£æ­¥ã€è·³èˆç­‰è¼•é‡é‹å‹•ï¼‰</label><div class="options"><label><input type="radio" name="q12_ex_freq" value="1:æ²’æœ‰">æ²’æœ‰</label><label><input type="radio" name="q12_ex_freq" value="2:1-2æ¬¡">1-2æ¬¡</label><label><input type="radio" name="q12_ex_freq" value="4:3æ¬¡ä»¥ä¸Š">3æ¬¡ä»¥ä¸Š</label></div>
<label>13. æ¯æ¬¡é‹å‹•æ™‚é–“ï¼Ÿ</label><div class="options"><label><input type="radio" name="q13_ex_dur" value="1:å°‘æ–¼15åˆ†é˜">å°‘æ–¼15åˆ†é˜</label><label><input type="radio" name="q13_ex_dur" value="2:15-30åˆ†é˜">15-30åˆ†é˜</label><label><input type="radio" name="q13_ex_dur" value="4:30åˆ†é˜ä»¥ä¸Š">30åˆ†é˜ä»¥ä¸Š</label></div>

    <label>14. æƒ³äº†è§£å“ªäº›å¥åº·è³‡è¨Šï¼ˆè¤‡é¸ï¼‰ï¼š</label>
    <div class="options">
      <label><input type="checkbox" name="q14_interest" value="ç¡çœ æ”¹å–„"> ç¡çœ æ”¹å–„</label>
      <label><input type="checkbox" name="q14_interest" value="å¿ƒæƒ…ç®¡ç†"> æƒ…ç·’ç®¡ç†</label>
      <label><input type="checkbox" name="q14_interest" value="è…¸èƒƒå¥åº·"> è…¸èƒƒå¥åº·</label>
      <label><input type="checkbox" name="q14_interest" value="çš®è†šä¿é¤Š"> çš®è†šä¿é¤Š</label>
      <label><input type="checkbox" name="q14_interest" value="é‹å‹•å¥èº«"> é‹å‹•å¥èº«</label>
    </div>

    <label>å…¶ä»–è£œå……ï¼š</label>
    <textarea name="comments" rows="3"></textarea>
    <button type="submit">æäº¤</button>
  </form>

  <div id="result"></div>
</div>

<script>
document.getElementById("healthForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const requiredRadios = [
    "q1_age", "q2_gender", "q3_shift", "q4_sleep", "q5_hours", "q6_fatigue",
    "q7_gut", "q8_bowel", "q9_bloat", "q10_emotion", "q11_skin",
    "q12_ex_freq", "q13_ex_dur"
  ];
  for (const name of requiredRadios) {
    const selected = document.querySelector(`input[name="${name}"]:checked`);
    if (!selected) {
      alert("è«‹å›ç­”æ‰€æœ‰å¿…å¡«é¡Œç›®ï¼ˆ1~14é¡Œï¼‰");
      return;
    }
  }

  const interestChecked = document.querySelectorAll('input[name="q14_interest"]:checked').length > 0;
  if (!interestChecked) {
    alert("è«‹è‡³å°‘é¸æ“‡ä¸€é …æ‚¨æ„Ÿèˆˆè¶£çš„ä¸»é¡Œï¼ˆç¬¬14é¡Œï¼‰");
    return;
  }
  const formData = new FormData(this);
  let score = 0;
  let risks = { gut: false, emotion: false, skin: false, muscle: false };
  let gutCount = 0;
  let emotionCount = 0;
  const skipKeys = ['q2_gender', 'q14_interest', 'comments'];

  for (const [key, val] of formData.entries()) {
    if (!skipKeys.includes(key)) {
      const [num] = val.split(":");
      const parsed = parseInt(num);
      if (!isNaN(parsed)) {
        score += parsed;

        if (['q7_gut', 'q8_bowel', 'q9_bloat'].includes(key) && parsed <= 2) gutCount++;
        if (['q4_sleep', 'q10_emotion'].includes(key) && parsed <= 2) emotionCount++;
        if (key === 'q11_skin' && parsed <= 2) risks.skin = true;
        if (key === 'q6_fatigue' && parsed <= 2) risks.muscle = true;
      }
    }
  }

  if (gutCount >= 2) risks.gut = true;
  if (emotionCount >= 1) risks.emotion = true;

  let suggestion = '';
  if (score >= 38) suggestion = "âœ… å¥åº·è‰¯å¥½ï¼Œè«‹ç¹¼çºŒä¿æŒè‰¯å¥½ç”Ÿæ´»ç¿’æ…£ã€‚";
  else if (score >= 30) suggestion = "âš ï¸ éœ€æ³¨æ„å¥åº·ç‹€æ³ï¼Œå»ºè­°èª¿æ•´ä½œæ¯èˆ‡é£²é£Ÿã€‚";
  else suggestion = "â¤ï¸ å»ºè­°æ”¹å–„ç”Ÿæ´»æ–¹å¼ï¼Œå¿…è¦æ™‚å°‹æ±‚å°ˆæ¥­é†«ç™‚å”åŠ©ã€‚";

  let products = '';
  if (risks.gut) products += "<li><a href='https://hskgene.com/products/probiolife-probiotics' target='_blank'>Probiolife é‡‘è£ç›Šçº–èŒ</a>ï¼šè…¸é“å¥åº·ä¿é¤Š</li>";
  if (risks.emotion) products += "<li><a href='https://hskgene.com/products/probiolife-lpc37' target='_blank'>Probiolife ç›Šç·’å¯§</a>ï¼šæƒ…ç·’èˆ‡ç¡çœ èª¿ç¯€</li>";
  if (risks.muscle) products += "<li><a href='https://hskgene.com/products/probiolife-slim-protein-familypack' target='_blank'>Probiolife ç›Šçº–è›‹ç™½</a>ï¼šå¢è‚Œæ¸›è„‚ï¼Œæå‡é«”åŠ›</li>";
  if (risks.skin) products += "<li><a href='https://hskgene.com/products/probiolife-algae-oil' target='_blank'>Probiolife å¥è—»æ²¹</a>ï¼šæ»‹é¤Šè‚Œè†šèˆ‡å¿ƒè…¦ä¿é¤Š</li>";

  // æ”¶é›†æ‰€æœ‰æ¬„ä½è³‡æ–™
  const fullData = {};
  for (const [key, val] of formData.entries()) {
    if (fullData[key]) {
      if (!Array.isArray(fullData[key])) fullData[key] = [fullData[key]];
      fullData[key].push(val);
    } else {
      fullData[key] = val;
    }
  }
  fullData["score"] = score;
  fullData["risks"] = risks;
  fullData["suggestion"] = suggestion;
  const now = new Date();
  const twTime = new Date(now.getTime() + 8 * 60 * 60 * 1000);
  const timestampTW = twTime.toISOString().replace("T", " ").substring(0, 19);
  fullData["timestamp"] = "'" + timestampTW + "'";

  if (Array.isArray(fullData["q14_interest"])) {
    fullData["q14_interest"] = fullData["q14_interest"].join(", ");
  }
  fullData["risk_gut"] = risks.gut;
  fullData["risk_emotion"] = risks.emotion;
  fullData["risk_skin"] = risks.skin;
  fullData["risk_muscle"] = risks.muscle;
  delete fullData["risks"];

  // ç™¼é€ webhook
  fetch("https://hook.us2.make.com/klsylbhfeljeooktadgf6ejh9jwv5mzd", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(fullData)
  })
    .then(r => console.log("âœ… Webhook sent"))
    .catch(err => console.error("Webhook failed", err));

  // è™•ç†èˆˆè¶£ç”¢å“æ¨è–¦
  const interestMap = {
  "ç¡çœ æ”¹å–„": "Probiolife ç›Šç·’å¯§ - æƒ…ç·’èˆ‡ç¡çœ èª¿ç¯€",
  "å¿ƒæƒ…ç®¡ç†": "Probiolife ç›Šç·’å¯§ - æƒ…ç·’èˆ‡ç¡çœ èª¿ç¯€",
  "è…¸èƒƒå¥åº·": "Probiolife é‡‘è£ç›Šçº–èŒ - è…¸é“å¥åº·ä¿é¤Š",
  "çš®è†šä¿é¤Š": "Probiolife å¥è—»æ²¹ - è‚Œè†šèˆ‡å¿ƒè…¦ä¿é¤Š",
  "é‹å‹•å¥èº«": "Probiolife ç›Šçº–è›‹ç™½ - å¢è‚Œæ¸›è„‚èˆ‡é«”åŠ›è£œå……"
};

const interestLinks = {
  "ç¡çœ æ”¹å–„": "https://hskgene.com/products/probiolife-lpc37",
  "å¿ƒæƒ…ç®¡ç†": "https://hskgene.com/products/probiolife-lpc37",
  "è…¸èƒƒå¥åº·": "https://hskgene.com/products/probiolife-probiotics",
  "çš®è†šä¿é¤Š": "https://hskgene.com/products/probiolife-algae-oil",
  "é‹å‹•å¥èº«": "https://hskgene.com/products/probiolife-slim-protein-familypack"
};


const interestProducts = new Set();
const interests = formData.getAll("q14_interest");
if (Array.isArray(interests)) {
  interests.forEach(i => {
    if (interestMap[i] && interestLinks[i]) {
      interestProducts.add("<li><a href='" + interestLinks[i] + "' target='_blank'>" + interestMap[i] + "</a></li>");
    }
  });
}


  // é¡¯ç¤ºçµæœ
  document.getElementById("result").innerHTML = `
    <div class="product-box">
      <h3>ç¸½åˆ†ï¼š${score} åˆ†</h3>
      <p>${suggestion}</p>
      ${products ? "<h4>ğŸ” æ¨è–¦ç”¢å“ï¼š</h4><ul>" + products + "</ul>" : ""}
      ${interestProducts.size > 0 ? "<h4>ğŸ¯ æ‚¨æ„Ÿèˆˆè¶£çš„ä¸»é¡Œï¼š</h4><ul>" + Array.from(interestProducts).join('') + "</ul>" : "<p>æœªå‹¾é¸æ„Ÿèˆˆè¶£ä¸»é¡Œ</p>"}
    </div>
  `;
  alert("âœ… æ„Ÿè¬æ‚¨çš„å¡«å¯«ï¼Œçµæœå·²é¡¯ç¤ºæ–¼ä¸‹æ–¹ï¼");
  this.reset();
});
</script>

  
</script>
</body>
</html>
